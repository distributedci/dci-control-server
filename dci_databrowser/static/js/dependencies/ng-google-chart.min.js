!function(r,e,t){"use strict";t.module("googlechart",[]).factory("FormatManager",function(){function r(){function r(r,e){var t,o;for(o in r)if(r.hasOwnProperty(o))for(t=0;t<i.iFormats[o].length;t++)r[o][t].columnNum<e.getNumberOfColumns()&&i.iFormats[o][t].format(e,r[o][t].columnNum)}function e(r,e,o){var n;if(t.isArray(o[r])&&!t.equals(o[r],c[r]))if(c[r]=o[r],i.iFormats[r]=[],"color"===r)a(o);else for(n=0;n<o[r].length;n++)i.iFormats[r].push(new e(o[r][n]))}function o(o,a,i){var c,s,l=!1;if(t.isDefined(a)&&t.isDefined(o)){for(c in a)if(a.hasOwnProperty(c)){if(s=n(c,i),!t.isFunction(s))continue;e(c,s,a),("arrow"===c||"bar"===c||"color"===c)&&(l=!0)}return r(a,o),{requiresHtml:l}}}function a(r){var e,t,o,a,n="color";for(e=0;e<r[n].length;e++){for(t=new google.visualization.ColorFormat,o=0;o<r[n][e].formats.length;o++)a=r[n][e].formats[o],"undefined"!=typeof a.fromBgColor&&"undefined"!=typeof a.toBgColor?t.addGradientRange(a.from,a.to,a.color,a.fromBgColor,a.toBgColor):t.addRange(a.from,a.to,a.color,a.bgcolor);i.iFormats[n].push(t)}}function n(r,e){var o=r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()+"Format";return google.visualization.hasOwnProperty(o)?google.visualization[o]:t.isDefined(e)&&e.hasOwnProperty(r)?e[r]:void 0}var i=this,c={};i.iFormats={},i.applyFormats=o}return r}).value("googleChartApiConfig",{version:"1",optionalSettings:{packages:["corechart"]}}).provider("googleJsapiUrl",function(){var r="https:",e="//www.google.com/jsapi";this.setProtocol=function(e){r=e},this.setUrl=function(r){e=r},this.$get=function(){return(r?r:"")+e}}).factory("googleChartApiPromise",["$rootScope","$q","googleChartApiConfig","googleJsapiUrl",function(o,a,n,i){var c=a.defer(),s=function(){var r={callback:function(){var r=n.optionalSettings.callback;o.$apply(function(){c.resolve()}),t.isFunction(r)&&r.call(this)}};r=t.extend({},n.optionalSettings,r),e.google.load("visualization",n.version,r)},l=r.getElementsByTagName("head")[0],p=r.createElement("script");return p.setAttribute("type","text/javascript"),p.src=i,p.addEventListener?p.addEventListener("load",s,!1):p.onreadystatechange=function(){("loaded"===p.readyState||"complete"===p.readyState)&&(p.onreadystatechange=null,s())},l.appendChild(p),c.promise}]).directive("googleChart",["$timeout","$window","$rootScope","googleChartApiPromise",function(r,e,o,a){function n(e,n,i,c,s){function l(){F()}function p(){p.triggered||void 0===A.chart?void 0!==A.chart&&(r.cancel(p.recallTimeout),p.recallTimeout=r(p,10)):(p.triggered=!0,r(m,0,!0))}function u(){a.then(function(){p()})}function g(){e.$eval(i.beforeDraw,{chartWrapper:e.chartWrapper}),A.chartWrapper.draw(),p.triggered=!1}function f(r){var e=r[0];console.log("Chart not displayed due to error: '"+e.message+"' Full error object follows."),console.log(e)}function h(){A.chart.displayed=!0,O!==A.chartWrapper.getChart()&&(O=A.chartWrapper.getChart(),$(O,j))}function d(){e.$watch(y,v,!0),F=o.$on("resizeMsg",function(){r(function(){A.chartWrapper&&u()})}),e.$on("$destroy",l()),C("error",f,A),C("ready",h,A)}function m(){if("undefined"==typeof A.chartWrapper){var e={chartType:A.chart.type,dataTable:A.chart.data,view:A.chart.view,options:A.chart.options,containerId:n[0]};A.chartWrapper=new google.visualization.ChartWrapper(e),$(A.chartWrapper,L)}else A.chartWrapper.setChartType(A.chart.type),A.chartWrapper.setDataTable(A.chart.data),A.chartWrapper.setView(A.chart.view),A.chartWrapper.setOptions(A.chart.options);b||(b=new s),b.applyFormats(A.chartWrapper.getDataTable(),A.chart.formatters,A.chart.customFormatters).requiresHtml&&A.chartWrapper.setOption("allowHtml",!0),r(g)}function v(){A.chart=e.$eval(i.chart),u()}function y(){var r=e.$eval(i.chart);return t.isDefined(r)&&t.isObject(r)?{customFormatters:r.customFormatters,data:r.data,formatters:r.formatters,options:r.options,type:r.type,view:r.view}:void 0}function w(r,e,o,a){var n=function(){var r={chartWrapper:A.chartWrapper,chart:A.chartWrapper.getChart(),args:arguments};c.invoke(o,a||this,r)};return t.isDefined(r)&&t.isObject(r)?(t.isArray(r[e])||(r[e]=[]),r[e].push(n),function(){t.isDefined(n.googleListenerHandle)&&google.visualization.events.removeListener(n.googleListenerHandle);var o=r[e].indexOf(n);r[e].splice(o,1),0===r[e].length&&(r[e]=void 0)}):void 0}function $(r,e){for(var o in e)if(e.hasOwnProperty(o)&&t.isArray(e[o]))for(var a=0;a<e[o].length;a++)t.isFunction(e[o][a])&&(e[o][a].googleListenerHandle=google.visualization.events.addListener(r,o,e[o][a]))}function W(r,e,t){return w(j,r,e,t)}function C(r,e,t){return w(L,r,e,t)}var F,b,A=this,L={},j={},O=null;A.registerChartListener=W,A.registerWrapperListener=C,d(),f.$inject=["args"]}return n.$inject=["$scope","$element","$attrs","$injector","FormatManager"],{restrict:"A",scope:!1,controller:n}}]).directive("onReady",function(){return{restrict:"A",scope:!1,require:"googleChart",link:function(r,e,t,o){function a(e){r.$apply(function(){r.$eval(t.onReady,{chartWrapper:e})})}a.$inject=["chartWrapper"],o.registerWrapperListener("ready",a,this)}}}).directive("onSelect",function(){return{restrict:"A",scope:!1,require:"googleChart",link:function(r,e,t,o){function a(e,o){var a={selectedItems:o.getSelection()};a.selectedItem=a.selectedItems[0],a.chartWrapper=e,a.chart=o,r.$apply(function(){r.$eval(t.onSelect,a)})}a.$inject=["chartWrapper","chart"],o.registerWrapperListener("select",a,this)}}}).directive("onError",function(){return{restrict:"A",scope:!1,require:"googleChart",link:function(r,e,t,o){function a(e,o,a){var n={chartWrapper:e,chart:o,args:a,error:a[0],err:a[0],id:a[0].id,message:a[0].message};r.$apply(function(){r.$eval(t.onError,n)})}a.$inject=["chartWrapper","chart","args"],o.registerWrapperListener("error",a,this)}}}).run(["$rootScope","$window",function(r,e){t.element(e).bind("resize",function(){r.$emit("resizeMsg")})}])}(document,window,window.angular);